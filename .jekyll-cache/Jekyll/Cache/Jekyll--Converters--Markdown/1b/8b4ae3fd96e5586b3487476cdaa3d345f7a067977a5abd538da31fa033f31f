I"<h2 id="mouse-hippocampus">Mouse hippocampus</h2>

<p>It is related with brain memory.</p>

<p>The embedding was computed using pagoda2, the distance is determined as $1-r_{ij}$ (r is pearson linear correlation of cell i,j on the first 100 principle compoinents of the top 3000 variable genes). Cluster was performed using Louvain community detection algorithm on the nearest neighbor cell graph.</p>

<p>Explore with code:</p>

<p>if %matplotlib inline turns error, you should put in front of the matplotlib import command, because some default setting things in jupyter notebook.</p>

<p><img src="https://github.com/clay001/blog/blob/gh-pages/_posts/posts_picture/Research(2)/procedure.png?raw=true" alt="procedure" /></p>

<p>There is two steps which I think is the most important, one is SVR, another is KNN.</p>

<p>After KNN, we will get:</p>

<ul>
  <li>knn contiguity matrix</li>
  <li>the weights used for the smoothing</li>
  <li>smoothed spliced</li>
  <li>smoothed unspliced</li>
</ul>

<p>Then use Sx and Ux to fit gamma to get the kinetic equations, plot the predict result for checking. Calculate the transition probability (here I fixed a bug about the stacking), project the direction (figure with small arrows) and use regular grid and gaussian kernel to smooth (figure with big arrows). We can access these two things in <strong>delta_embedding</strong> and <strong>flow</strong> attribute.</p>

<p><img src="https://github.com/clay001/blog/blob/gh-pages/_posts/posts_picture/Research(2)/small_arrow.png?raw=true" alt="small_arrow" /></p>

<p><img src="https://github.com/clay001/blog/blob/gh-pages/_posts/posts_picture/Research(2)/big_arrow.png?raw=true" alt="big_arrow" /></p>

<p>Then is some different plot styles and some particular regions zoom in module.(To be continuedâ€¦. )</p>
:ET